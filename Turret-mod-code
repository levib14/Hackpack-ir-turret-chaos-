// IR Turret Mod Code - Enhanced with Rapid Fire Functionality
// Author: levib14
// Date: 2025-12-30
// Description: IR codes for turret control with button mappings and rapid fire modes

// Button Mappings:
// Vol+ (Code: 0xE0E016E9) - Rapid Fire 2 Rounds
// Vol- (Code: 0xE0E036C9) - Rapid Fire 3 Rounds
// Ch+ (Code: 0xE0E026D9) - Rapid Fire 4 Rounds
// Ch- (Code: 0xE0E046B9) - Rapid Fire 5 Rounds

#define VOL_PLUS_RAPID_2   0xE0E016E9  // Volume+ button - Fires 2 rounds rapid
#define VOL_MINUS_RAPID_3  0xE0E036C9  // Volume- button - Fires 3 rounds rapid
#define CH_PLUS_RAPID_4    0xE0E026D9  // Channel+ button - Fires 4 rounds rapid
#define CH_MINUS_RAPID_5   0xE0E046B9  // Channel- button - Fires 5 rounds rapid

// Rapid Fire Delay Configuration (in milliseconds)
#define RAPID_FIRE_DELAY   100  // Delay between each shot

// Function to execute rapid fire sequence
void executeRapidFire(int roundCount) {
  for (int i = 0; i < roundCount; i++) {
    fire();
    delay(RAPID_FIRE_DELAY);
  }
}

// IR Receiver Handler
void handleIRCode(unsigned long irCode) {
  switch(irCode) {
    case VOL_PLUS_RAPID_2:
      // Execute 2-round rapid fire
      executeRapidFire(2);
      break;
      
    case VOL_MINUS_RAPID_3:
      // Execute 3-round rapid fire
      executeRapidFire(3);
      break;
      
    case CH_PLUS_RAPID_4:
      // Execute 4-round rapid fire
      executeRapidFire(4);
      break;
      
    case CH_MINUS_RAPID_5:
      // Execute 5-round rapid fire
      executeRapidFire(5);
      break;
      
    default:
      // Handle other IR codes if needed
      break;
  }
}

// Main setup function
void setup() {
  Serial.begin(9600);
  initializeIRReceiver();
  initializeTurretControls();
}

// Main loop function
void loop() {
  if (irReceiverAvailable()) {
    unsigned long irCode = getIRCode();
    handleIRCode(irCode);
  }
}
